# docker network create --internal --driver bridge app_backend

services:
  reverse-proxy:
    image: nginx
    networks: [frontend, obs_net, arti_net]

  grafana:
    image: grafana/grafana
    networks: [obs_net]

  prometheus:
    image: prom/prometheus
    networks: [obs_net, app_backend]   # or only obs_net if you use a gateway pattern

  loki:
    image: grafana/loki
    networks: [obs_net]

  app:
    image: myorg/app
    networks: [app_backend, db_net]

  postgres:
    image: postgres:16
    networks: [db_net]

  artifactory:
    image: docker.bintray.io/jfrog/artifactory-oss:latest
    networks: [arti_net, db_net]  # if it uses DB; otherwise just arti_net

networks:
  frontend: { name: app_frontend }          # not internal
  obs_net:  { name: app_obs,  internal: true }
  arti_net: { name: app_arti, internal: true }
  db_net:   { name: app_db,   internal: true }
  app_backend: { name: app_backend, internal: true }